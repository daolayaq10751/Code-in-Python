import numpy as np

bins = np.arange(500000, 1500001, 10000)

# Lista
all_counts = []
all_bin_centers = []
total_firmas = []

# listas de firmas por bin para cada año
for year in range(2008, 2013):
    patr_column = f'PATR_L_{year}'

    df_filtered = df_merged_final2[(df_merged_final2[patr_column] >= 500000) &
                                   (df_merged_final2[patr_column] <= 1500000)]

    # Calcular los valores del histograma para la línea de tendencia
    counts, bin_edges = np.histogram(df_filtered[patr_column], bins=bins)

    # Calcular los centros de las barras (bin_centers)
    bin_centers = 0.5 * (bin_edges[1:] + bin_edges[:-1])

    # Guardar los resultados
    total_firmas.append(len(df_filtered))
    all_counts.append(counts.tolist())
    all_bin_centers.append(bin_centers.tolist())



# Imprimir los resultados

for idx, year in enumerate(range(2008, 2013)):
    print(f"\nAño {year}:")

    # Mostrar el número total de firmas que cumplen el rango
    print(f"  Total de firmas en el rango 500M a 1,500M: {total_firmas[idx]}")

    print(f"  Concentración de firmas en cada bin:")
    for i in range(0, len(all_counts[idx]), 10):  # Mostrar 10 valores por línea
        print(f"    {all_counts[idx][i:i+10]}")  # Imprimir los valores en bloques de 10

    print(f"  Rango de patrimonio líquido en cada bin (en miles de pesos):")
    # Imprimir los rangos de los bins en varias filas
    for i in range(0, len(all_bin_centers[idx]), 10):
        print(f"    {all_bin_centers[idx][i:i+10]}")


RESULTADOS:

Año 2008:
  Total de firmas en el rango 500M a 1,500M: 4105
  Concentración de firmas en cada bin:
    [70, 64, 92, 88, 84, 68, 65, 70, 68, 70]
    [60, 81, 63, 69, 70, 64, 48, 59, 62, 54]
    [47, 63, 58, 56, 59, 50, 56, 54, 50, 53]
    [48, 61, 45, 62, 52, 48, 38, 46, 44, 35]
    [45, 33, 44, 37, 40, 40, 32, 36, 37, 39]
    [26, 24, 35, 26, 28, 37, 37, 35, 24, 32]
    [34, 23, 37, 33, 27, 29, 26, 25, 28, 30]
    [18, 28, 30, 29, 29, 25, 21, 29, 26, 27]
    [26, 33, 27, 37, 30, 21, 25, 18, 15, 21]
    [21, 20, 24, 17, 22, 30, 25, 19, 20, 19]
  Rango de patrimonio líquido en cada bin (en miles de pesos):
    [505000.0, 515000.0, 525000.0, 535000.0, 545000.0, 555000.0, 565000.0, 575000.0, 585000.0, 595000.0]
    [605000.0, 615000.0, 625000.0, 635000.0, 645000.0, 655000.0, 665000.0, 675000.0, 685000.0, 695000.0]
    [705000.0, 715000.0, 725000.0, 735000.0, 745000.0, 755000.0, 765000.0, 775000.0, 785000.0, 795000.0]
    [805000.0, 815000.0, 825000.0, 835000.0, 845000.0, 855000.0, 865000.0, 875000.0, 885000.0, 895000.0]
    [905000.0, 915000.0, 925000.0, 935000.0, 945000.0, 955000.0, 965000.0, 975000.0, 985000.0, 995000.0]
    [1005000.0, 1015000.0, 1025000.0, 1035000.0, 1045000.0, 1055000.0, 1065000.0, 1075000.0, 1085000.0, 1095000.0]
    [1105000.0, 1115000.0, 1125000.0, 1135000.0, 1145000.0, 1155000.0, 1165000.0, 1175000.0, 1185000.0, 1195000.0]
    [1205000.0, 1215000.0, 1225000.0, 1235000.0, 1245000.0, 1255000.0, 1265000.0, 1275000.0, 1285000.0, 1295000.0]
    [1305000.0, 1315000.0, 1325000.0, 1335000.0, 1345000.0, 1355000.0, 1365000.0, 1375000.0, 1385000.0, 1395000.0]
    [1405000.0, 1415000.0, 1425000.0, 1435000.0, 1445000.0, 1455000.0, 1465000.0, 1475000.0, 1485000.0, 1495000.0]

Año 2009:
  Total de firmas en el rango 500M a 1,500M: 5706
  Concentración de firmas en cada bin:
    [113, 129, 93, 98, 113, 90, 113, 112, 90, 111]
    [97, 93, 97, 84, 92, 78, 91, 80, 84, 98]
    [80, 89, 99, 78, 74, 73, 73, 70, 71, 78]
    [76, 73, 75, 69, 71, 71, 56, 68, 76, 56]
    [65, 58, 67, 66, 55, 68, 72, 72, 58, 62]
    [41, 41, 40, 39, 36, 38, 31, 30, 30, 45]
    [33, 42, 46, 33, 39, 37, 31, 36, 38, 35]
    [37, 33, 30, 32, 34, 28, 40, 27, 33, 28]
    [32, 28, 35, 33, 28, 25, 42, 37, 22, 27]
    [37, 38, 23, 18, 30, 20, 29, 16, 26, 22]
  Rango de patrimonio líquido en cada bin (en miles de pesos):
    [505000.0, 515000.0, 525000.0, 535000.0, 545000.0, 555000.0, 565000.0, 575000.0, 585000.0, 595000.0]
    [605000.0, 615000.0, 625000.0, 635000.0, 645000.0, 655000.0, 665000.0, 675000.0, 685000.0, 695000.0]
    [705000.0, 715000.0, 725000.0, 735000.0, 745000.0, 755000.0, 765000.0, 775000.0, 785000.0, 795000.0]
    [805000.0, 815000.0, 825000.0, 835000.0, 845000.0, 855000.0, 865000.0, 875000.0, 885000.0, 895000.0]
    [905000.0, 915000.0, 925000.0, 935000.0, 945000.0, 955000.0, 965000.0, 975000.0, 985000.0, 995000.0]
    [1005000.0, 1015000.0, 1025000.0, 1035000.0, 1045000.0, 1055000.0, 1065000.0, 1075000.0, 1085000.0, 1095000.0]
    [1105000.0, 1115000.0, 1125000.0, 1135000.0, 1145000.0, 1155000.0, 1165000.0, 1175000.0, 1185000.0, 1195000.0]
    [1205000.0, 1215000.0, 1225000.0, 1235000.0, 1245000.0, 1255000.0, 1265000.0, 1275000.0, 1285000.0, 1295000.0]
    [1305000.0, 1315000.0, 1325000.0, 1335000.0, 1345000.0, 1355000.0, 1365000.0, 1375000.0, 1385000.0, 1395000.0]
    [1405000.0, 1415000.0, 1425000.0, 1435000.0, 1445000.0, 1455000.0, 1465000.0, 1475000.0, 1485000.0, 1495000.0]

Año 2010:
  Total de firmas en el rango 500M a 1,500M: 5572
  Concentración de firmas en cada bin:
    [94, 94, 124, 96, 116, 82, 87, 76, 80, 70]
    [88, 82, 84, 79, 84, 76, 70, 68, 85, 92]
    [92, 86, 95, 63, 72, 75, 84, 60, 77, 69]
    [63, 74, 81, 65, 53, 78, 48, 54, 70, 71]
    [73, 72, 45, 71, 78, 72, 82, 71, 86, 91]
    [50, 43, 45, 46, 28, 41, 46, 29, 32, 44]
    [29, 35, 47, 41, 33, 44, 21, 31, 32, 24]
    [32, 27, 29, 29, 35, 35, 27, 37, 35, 31]
    [24, 25, 33, 28, 22, 31, 33, 41, 33, 34]
    [44, 26, 31, 27, 20, 29, 29, 32, 45, 29]
  Rango de patrimonio líquido en cada bin (en miles de pesos):
    [505000.0, 515000.0, 525000.0, 535000.0, 545000.0, 555000.0, 565000.0, 575000.0, 585000.0, 595000.0]
    [605000.0, 615000.0, 625000.0, 635000.0, 645000.0, 655000.0, 665000.0, 675000.0, 685000.0, 695000.0]
    [705000.0, 715000.0, 725000.0, 735000.0, 745000.0, 755000.0, 765000.0, 775000.0, 785000.0, 795000.0]
    [805000.0, 815000.0, 825000.0, 835000.0, 845000.0, 855000.0, 865000.0, 875000.0, 885000.0, 895000.0]
    [905000.0, 915000.0, 925000.0, 935000.0, 945000.0, 955000.0, 965000.0, 975000.0, 985000.0, 995000.0]
    [1005000.0, 1015000.0, 1025000.0, 1035000.0, 1045000.0, 1055000.0, 1065000.0, 1075000.0, 1085000.0, 1095000.0]
    [1105000.0, 1115000.0, 1125000.0, 1135000.0, 1145000.0, 1155000.0, 1165000.0, 1175000.0, 1185000.0, 1195000.0]
    [1205000.0, 1215000.0, 1225000.0, 1235000.0, 1245000.0, 1255000.0, 1265000.0, 1275000.0, 1285000.0, 1295000.0]
    [1305000.0, 1315000.0, 1325000.0, 1335000.0, 1345000.0, 1355000.0, 1365000.0, 1375000.0, 1385000.0, 1395000.0]
    [1405000.0, 1415000.0, 1425000.0, 1435000.0, 1445000.0, 1455000.0, 1465000.0, 1475000.0, 1485000.0, 1495000.0]

Año 2011:
  Total de firmas en el rango 500M a 1,500M: 6238
  Concentración de firmas en cada bin:
    [129, 99, 109, 90, 127, 116, 118, 109, 98, 98]
    [88, 86, 88, 94, 103, 94, 86, 101, 85, 90]
    [95, 113, 75, 77, 89, 83, 69, 83, 89, 84]
    [75, 93, 93, 78, 67, 72, 73, 73, 88, 67]
    [58, 69, 87, 64, 82, 63, 69, 80, 83, 84]
    [57, 60, 45, 44, 45, 48, 53, 42, 44, 50]
    [40, 32, 51, 33, 39, 50, 43, 28, 36, 38]
    [31, 33, 33, 39, 35, 35, 36, 38, 35, 34]
    [34, 43, 42, 33, 36, 31, 26, 39, 23, 24]
    [26, 28, 37, 29, 36, 33, 35, 24, 29, 20]
  Rango de patrimonio líquido en cada bin (en miles de pesos):
    [505000.0, 515000.0, 525000.0, 535000.0, 545000.0, 555000.0, 565000.0, 575000.0, 585000.0, 595000.0]
    [605000.0, 615000.0, 625000.0, 635000.0, 645000.0, 655000.0, 665000.0, 675000.0, 685000.0, 695000.0]
    [705000.0, 715000.0, 725000.0, 735000.0, 745000.0, 755000.0, 765000.0, 775000.0, 785000.0, 795000.0]
    [805000.0, 815000.0, 825000.0, 835000.0, 845000.0, 855000.0, 865000.0, 875000.0, 885000.0, 895000.0]
    [905000.0, 915000.0, 925000.0, 935000.0, 945000.0, 955000.0, 965000.0, 975000.0, 985000.0, 995000.0]
    [1005000.0, 1015000.0, 1025000.0, 1035000.0, 1045000.0, 1055000.0, 1065000.0, 1075000.0, 1085000.0, 1095000.0]
    [1105000.0, 1115000.0, 1125000.0, 1135000.0, 1145000.0, 1155000.0, 1165000.0, 1175000.0, 1185000.0, 1195000.0]
    [1205000.0, 1215000.0, 1225000.0, 1235000.0, 1245000.0, 1255000.0, 1265000.0, 1275000.0, 1285000.0, 1295000.0]
    [1305000.0, 1315000.0, 1325000.0, 1335000.0, 1345000.0, 1355000.0, 1365000.0, 1375000.0, 1385000.0, 1395000.0]
    [1405000.0, 1415000.0, 1425000.0, 1435000.0, 1445000.0, 1455000.0, 1465000.0, 1475000.0, 1485000.0, 1495000.0]

Año 2012:
  Total de firmas en el rango 500M a 1,500M: 6171
  Concentración de firmas en cada bin:
    [96, 109, 110, 110, 88, 118, 98, 106, 90, 88]
    [103, 97, 86, 86, 92, 95, 84, 93, 81, 92]
    [89, 90, 105, 76, 68, 76, 77, 75, 95, 81]
    [86, 88, 90, 68, 79, 59, 82, 78, 84, 68]
    [66, 91, 71, 64, 61, 69, 58, 67, 74, 72]
    [41, 62, 53, 51, 49, 50, 57, 30, 51, 40]
    [45, 46, 58, 55, 40, 51, 38, 32, 39, 43]
    [41, 33, 35, 36, 41, 31, 33, 32, 30, 48]
    [28, 21, 37, 34, 28, 42, 44, 27, 38, 34]
    [25, 36, 40, 26, 27, 44, 29, 35, 27, 29]
  Rango de patrimonio líquido en cada bin (en miles de pesos):
    [505000.0, 515000.0, 525000.0, 535000.0, 545000.0, 555000.0, 565000.0, 575000.0, 585000.0, 595000.0]
    [605000.0, 615000.0, 625000.0, 635000.0, 645000.0, 655000.0, 665000.0, 675000.0, 685000.0, 695000.0]
    [705000.0, 715000.0, 725000.0, 735000.0, 745000.0, 755000.0, 765000.0, 775000.0, 785000.0, 795000.0]
    [805000.0, 815000.0, 825000.0, 835000.0, 845000.0, 855000.0, 865000.0, 875000.0, 885000.0, 895000.0]
    [905000.0, 915000.0, 925000.0, 935000.0, 945000.0, 955000.0, 965000.0, 975000.0, 985000.0, 995000.0]
    [1005000.0, 1015000.0, 1025000.0, 1035000.0, 1045000.0, 1055000.0, 1065000.0, 1075000.0, 1085000.0, 1095000.0]
    [1105000.0, 1115000.0, 1125000.0, 1135000.0, 1145000.0, 1155000.0, 1165000.0, 1175000.0, 1185000.0, 1195000.0]
    [1205000.0, 1215000.0, 1225000.0, 1235000.0, 1245000.0, 1255000.0, 1265000.0, 1275000.0, 1285000.0, 1295000.0]
    [1305000.0, 1315000.0, 1325000.0, 1335000.0, 1345000.0, 1355000.0, 1365000.0, 1375000.0, 1385000.0, 1395000.0]
    [1405000.0, 1415000.0, 1425000.0, 1435000.0, 1445000.0, 1455000.0, 1465000.0, 1475000.0, 1485000.0, 1495000.0]
